{% extends "processes/team_wizard.html" %}
{% load django_bootstrap5 %}

{% block wizard_content %}
    <div class="callout-info">
        <p>Select the teams you want to update with GitHub and/or Taiga integration information.</p>
    </div>

    <div class="team-selection-container">
        <div class="mb-3">
            <button type="button" class="btn btn-sm btn-primary" id="select-all">Select All</button>
            <button type="button" class="btn btn-sm btn-secondary" id="deselect-all">Deselect All</button>
        </div>

        <div class="row g-3">
            {% for team in teams_list %}
            <div class="col-md-6 col-lg-4">
                <div class="card team-card">
                    <div class="card-body">
                        <div class="form-check">
                            <input type="checkbox" 
                                   class="form-check-input team-checkbox" 
                                   name="teams" 
                                   value="{{ team.id }}" 
                                   id="team_{{ team.id }}">
                            <label class="form-check-label" for="team_{{ team.id }}">
                                <h6 class="mb-1">{{ team.name }}</h6>
                                {% if team.description %}
                                    <small class="text-muted">{{ team.description|truncatewords:10 }}</small>
                                {% endif %}
                                <div class="mt-2">
                                    {% if team.github_repo_name %}
                                        <span class="badge bg-secondary"><i class="fa fa-github"></i> {{ team.github_repo_name }}</span>
                                    {% endif %}
                                    {% if team.taiga_project %}
                                        <span class="badge bg-info"><i class="fa fa-tasks"></i> {{ team.taiga_project }}</span>
                                    {% endif %}
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="col-12">
                <div class="alert alert-warning">
                    <i class="fa fa-warning"></i> No teams found for the selected course.
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <script>
    $(document).ready(function() {
        $('#select-all').click(function() {
            $('.team-checkbox').prop('checked', true);
        });

        $('#deselect-all').click(function() {
            $('.team-checkbox').prop('checked', false);
        });
    });
    </script>

    <style>
    .team-card {
        transition: border-color 0.3s;
        border: 2px solid transparent;
    }

    .team-card:has(.team-checkbox:checked) {
        border-color: var(--bs-primary);
        background-color: var(--bs-light);
    }

    .team-checkbox {
        cursor: pointer;
    }
    </style>
{% endblock %}