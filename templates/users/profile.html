{% extends 'core/base.html' %}

{% block title %}User Profile{% endblock %}

{% block content %}
<div class="content">
  <div class="row">
    <div class="col-md-8">
      <div class="card">
        <div class="card-header">
          <h5 class="title">User Profile</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-4">
              <div class="form-group">
                <label>Username</label>
                <p>{{ user.username }}</p>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label>Email</label>
                <p>{{ user.email }}</p>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label>Name</label>
                <p>{{ user.get_full_name }}</p>
              </div>
            </div>
          </div>
          
          <div class="row">
            <div class="col-md-12">
              <div class="form-group">
                <label>Role</label>
                <p>
                  {% if is_professor %}
                    Professor
                  {% elif is_ta %}
                    Teaching Assistant
                  {% elif is_student %}
                    Student
                  {% else %}
                    Other
                  {% endif %}
                </p>
              </div>
            </div>
          </div>
          
          {% if is_student %}
          <div class="row">
            <div class="col-md-12">
              <div class="form-group">
                <label>Team</label>
                <p>
                  {% if team %}
                    <a href="{% url 'team_detail' team.id %}">{{ team.name }}</a>
                  {% else %}
                    Not assigned to a team
                  {% endif %}
                </p>
              </div>
            </div>
          </div>
          
          {% if team %}
          <div class="row">
            <div class="col-md-12">
              <div class="form-group">
                <label>Repositories</label>
                <ul>
                  {% for repo in repositories %}
                    <li>
                      <a href="{{ repo.github_clone_url }}" target="_blank">{{ repo.name }}</a>
                      {% if repo.description %} - {{ repo.description }}{% endif %}
                    </li>
                  {% empty %}
                    <li>No repositories assigned</li>
                  {% endfor %}
                </ul>
              </div>
            </div>
          </div>
          {% endif %}
          {% endif %}
          
          {% if is_professor or is_ta %}
          <div class="row">
            <div class="col-md-12">
              <div class="form-group">
                <a href="{% url 'teams' %}" class="btn btn-primary">Manage Teams</a>
                {% if is_professor %}
                <a href="{% url 'manage_user_roles' %}" class="btn btn-primary">Manage User Roles</a>
                {% endif %}
              </div>
            </div>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
    
    <div class="col-md-4">
      <div class="card card-user">
        <div class="image">
          <img src="/static/img/bg/damir-bosnjak.jpg" alt="Background">
        </div>
        <div class="card-body">
          <div class="author">
            {% if user.user_profile.profile_picture %}
              <img class="avatar border-gray" src="{{ user.user_profile.profile_picture.url }}" alt="Profile Picture">
            {% else %}
              <img class="avatar border-gray" src="/static/img/faces/default-avatar.png" alt="Default Avatar">
            {% endif %}
            <h5 class="title">{{ user.get_full_name }}</h5>
            <p class="description">{{ user.username }}</p>
          </div>
          <p class="description text-center">
            {% if user.user_profile.bio %}
              {{ user.user_profile.bio }}
            {% else %}
              No bio provided
            {% endif %}
          </p>
        </div>
        <div class="card-footer">
          <hr>
          <div class="button-container">
            <div class="row">
              <div class="col-lg-6 col-md-6 col-6 ml-auto">
                <h5>{{ user.date_joined|date:"M d, Y" }}<br><small>Joined</small></h5>
              </div>
              <div class="col-lg-6 col-md-6 col-6 ml-auto mr-auto">
                <h5>
                  {% if is_professor %}
                    Professor
                  {% elif is_ta %}
                    TA
                  {% elif is_student %}
                    Student
                  {% else %}
                    User
                  {% endif %}
                  <br><small>Role</small>
                </h5>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
